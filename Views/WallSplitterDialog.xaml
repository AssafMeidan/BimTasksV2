<Window x:Class="BimTasksV2.Views.WallSplitterDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Wall Splitter"
        MinWidth="600" MinHeight="450"
        Width="700" Height="520"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResizeWithGrip"
        ShowInTaskbar="False">

    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Top info bar -->
        <TextBlock Grid.Row="0"
                   Text="{Binding InfoText}"
                   FontSize="14" FontWeight="SemiBold"
                   Margin="0,0,0,8"/>

        <!-- Layer DataGrid -->
        <DataGrid Grid.Row="1"
                  AutoGenerateColumns="False"
                  ItemsSource="{Binding LayerRows}"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  IsReadOnly="False"
                  SelectionMode="Single"
                  Margin="0,0,0,4">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Layer" Binding="{Binding Index}" Width="50" IsReadOnly="True"/>
                <DataGridTextColumn Header="Function" Binding="{Binding FunctionName}" Width="120" IsReadOnly="True"/>
                <DataGridTextColumn Header="Material" Binding="{Binding MaterialName}" Width="*" IsReadOnly="True"/>
                <DataGridTextColumn Header="Thickness (mm)" Binding="{Binding ThicknessMm}" Width="110" IsReadOnly="True">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="TextAlignment" Value="Right"/>
                            <Setter Property="Margin" Value="0,0,8,0"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTemplateColumn Header="Type" Width="180">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <ComboBox ItemsSource="{Binding AvailableTypes}"
                                      SelectedItem="{Binding SelectedType, UpdateSourceTrigger=PropertyChanged}"
                                      DisplayMemberPath="DisplayName"
                                      Margin="2"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Auto-create note -->
        <TextBlock Grid.Row="2"
                   Text="Types marked * will be auto-created"
                   FontStyle="Italic" Foreground="Gray"
                   Margin="0,0,0,8"/>

        <!-- Hosted Elements section -->
        <GroupBox Grid.Row="3"
                  x:Name="HostedElementsGroup"
                  Margin="0,0,0,8"
                  Visibility="Collapsed">
            <GroupBox.Header>
                <TextBlock x:Name="HostedElementsHeader" FontWeight="SemiBold"/>
            </GroupBox.Header>
            <StackPanel x:Name="HostedRadioPanel" Margin="4"/>
        </GroupBox>

        <!-- Scope section -->
        <GroupBox Grid.Row="4" Header="Scope" Margin="0,0,0,12">
            <StackPanel Margin="4">
                <RadioButton x:Name="ScopeSelected"
                             Content="Selected walls only"
                             GroupName="Scope"
                             IsChecked="True"
                             Margin="0,2"/>
                <RadioButton x:Name="ScopeAll"
                             Content="All walls of this type in project"
                             GroupName="Scope"
                             Margin="0,2"/>
            </StackPanel>
        </GroupBox>

        <!-- Buttons -->
        <StackPanel Grid.Row="5" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="Split" Width="80" Height="28"
                    Margin="0,0,8,0" IsDefault="True"
                    Click="SplitButton_Click"/>
            <Button Content="Cancel" Width="80" Height="28"
                    IsCancel="True"
                    Click="CancelButton_Click"/>
        </StackPanel>
    </Grid>
</Window>
